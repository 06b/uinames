function capitalize(string){return string.charAt(0).toUpperCase()+string.slice(1)}function selectThis(elem){var range,selection,elem=(elem instanceof Element)?elem:this;if(document.body.createTextRange){range=document.body.createTextRange();range.moveToElementText(elem);range.select()}else if(window.getSelection){selection=window.getSelection();range=document.createRange();range.selectNodeContents(elem);selection.removeAllRanges();selection.addRange(range)}}(function(){var $body=$('body'),$genderToggles=$('#genderSelect'),$regionToggle=$('.icon.region:first'),$bulkToggle=$('#bulk .icon'),$infoToggle=$('.info:first'),$cryptoToggle=$('#crypto-button a:first'),$regionPopup=$('#region'),$searchInput=$regionPopup.find('input:first'),$availableRegions=$regionPopup.find('li'),$name=$('#name'),$specs=$('#data');$('.click-to-select').click(selectThis);$body.on('mousedown keydown',function(e){$body.toggleClass('mouseDetected',e.type=='mousedown')});$availableRegions.click(function(){var $this=$(this);$availableRegions.removeClass('active');$this.addClass('active');var regionName=$this.find('.region-label:first').html();localStorage.setItem('region',regionName);var randName=$this.attr('id')=='region-0'?1:0;$regionToggle.find('img').attr('src','assets/img/'+(randName?'flag-random.gif':'flags.png')).css({'height':randName?'20px':'auto','top':randName?'0':('-'+($this.attr('id').replace('region-','')-1)*20+'px'),'border-radius':randName?'':'0'});$regionToggle.find('b').innerHTML=regionName+' selected';setTimeout(function(){closePopup()},250)});var storedRegion=localStorage.getItem('region');if(storedRegion){$availableRegions.each(function(){if(storedRegion==$(this).find('.region-label:first').html()){$(this).click();return false}})}else{}var namesRequested=0,maxNamesRequested=25,data,oldRegion,oldGender;function getName(){var region=$regionPopup.find('.active:first .region-label:first').html().toLowerCase().replace(/ /g,'+'),gender=$genderToggles.find('.active:first').attr('href'),gender=gender.substr(gender.indexOf('#')+1);function injectData(data,offset){$name.html('<h1>'+data[offset]['name']+' '+data[offset]['surname']+'</h1>');var specsData='';$.each({'Gender':capitalize(data[offset]['gender']),'Region':data[offset]['region'],'Phone':data[offset]['phone'],'Birthday':data[offset]['birthday']['dmy'],'Email':data[offset]['email'],'Password':data[offset]['password']},function(key,val){specsData+='<li><span class="label">'+key+':</span> <span class="click-to-select">'+val+'</span></li>'});var photo='<div class="photo-container"><a href="'+data[offset]['photo']+'" target="_blank" class="photo"><img src="'+data[offset]['photo'].replace(/http:\/\/uinames\.com\//,'')+'" /></a><a class="photo-more-link" href="https://unsplash.com/search/photos/people" target="_blank">More</a><a href="https://unsplash.com/license" target="_blank">License</a></div>';$specs.html('<a id="data-open">Show Details</a><div>'+photo+'<ul>'+specsData+'</ul><a id="data-exit"></a></div>');$('.click-to-select').click(selectThis);$('#data-exit').click(function(){$specs.find('div').fadeOut(250);$('#data-open').delay(250).fadeIn(250)});$('#data-open').click(function(){$('#data-open').fadeOut(250);$specs.find('div').delay(250).fadeIn(250)});if($bulkToggle.hasClass('active')){$specs.fadeOut(250);$body.addClass('bulk bulkPause');var bulkNames='';for(var i=0;i<maxNamesRequested;i+=1){bulkNames+='<h1>'+data[i]['name']+' '+data[i]['surname']+'</h1><p>'+capitalize(data[i]['gender'])+' from '+data[i]['region']+'</p>'}$name.html(bulkNames);var bulkToggleCache=$bulkToggle.html(),count=10,bulkCountDown=setInterval(function(){if(count===0||!$bulkToggle.hasClass('active')){$body.removeClass('bulkPause');$bulkToggle.html(bulkToggleCache).css({lineHeight:''});clearInterval(bulkCountDown)}else{$bulkToggle.html(count--).css({lineHeight:'200%'})}},650)}else{$body.removeClass('bulk');$specs.fadeIn(250)}$name.show().find('h1').click(selectThis).on('touchend',function(){getName()});}function injectNewData(){var getJSON=new XMLHttpRequest();getJSON.onreadystatechange=function(){if(getJSON.readyState==4&&getJSON.status==200){data=JSON.parse(getJSON.responseText);injectData(data,0)}};getJSON.open('GET','api/?ext&amount='+maxNamesRequested+'&region='+region+'&gender='+gender,true);getJSON.send();namesRequested=0}if(namesRequested==0||namesRequested>=maxNamesRequested||oldRegion!=region||oldGender!=gender||$bulkToggle.hasClass('active')){injectNewData()}else{injectData(data,namesRequested)}namesRequested+=1;oldRegion=region;oldGender=gender}$genderToggles.find('a').click(function(e){e.preventDefault();e.stopPropagation();$genderToggles.find('a').removeClass('active').attr('aria-pressed','active');$(this).addClass('active')});$bulkToggle.click(function(e){e.preventDefault();e.stopPropagation();if($(this).hasClass('bulk')){$(this).toggleClass('active').attr('aria-pressed',$(this).hasClass('active'))}});var trigger;function closePopup(){if($('#region').hasClass('visible')){$regionPopup.find('input').blur();$('#destination').focus();$searchInput.off('keyup')}$('.popover').hide().removeClass('visible');$('#overlay').removeClass('visible');$('.popover-trigger').removeClass('active');if(trigger&&!$body.hasClass('mouseDetected')){trigger.focus()}}function togglePopup(e){e.preventDefault();e.stopPropagation();trigger=this;var name=(this.hash)?this.hash.substr(1):$(this).attr('data-href');if($('#'+name).is(':visible')){closePopup()}else{$.each($('#'+name+' .lazy'),function(i,elem){setTimeout(function(){$(elem).attr('src',$(elem).attr('data-src'))},i*15)});if(name=='region'){setTimeout(function(){$searchInput.keyup(search)},150)}$('#overlay').addClass('visible');$('.popover').fadeOut(250).filter('#'+name).fadeIn(250);$(this).addClass('active');if(name=='region'){$regionPopup.find('input:first').focus()}}$('#overlay').click(closePopup)}$('.popover-trigger').click(togglePopup);var $tabs=$('#tabs a');$tabs.click(function(e){e.preventDefault();e.stopPropagation();$("[id$='-panel']").hide();$('#'+this.hash.substr(1)).show();$tabs.removeClass('active').find('b').html('');$(this).addClass('active').find('b').html('(Selected)')});function search(e){var n=e.which||e.keyCode||0,$filteredRegions=$availableRegions.not('.inactive'),$current=$filteredRegions.filter('.highlight');if(n==13){$current.click()}else if(n==35||n==36||n==38||n==40){$availableRegions.removeClass('highlight');if($filteredRegions.length>=1){if(n==36){$filteredRegions.first().addClass('highlight')}else if(n==35){$filteredRegions.last().addClass('highlight')}else if(n==38){$current.length>0?$current.prev().addClass('highlight'):$filteredRegions.last().addClass('highlight')}else if(n==40){$current.length>0?$current.next().addClass('highlight'):$filteredRegions.first().addClass('highlight')}}if($current.length>0){$searchInput.attr('aria-activedescendant',$current[0].id)}}else{$availableRegions.each(function(){var searchMatch=$(this).find('.region-label').text().toLowerCase().indexOf($searchInput.val().toLowerCase(),0)!==0;$(this).toggleClass('inactive',searchMatch)});var regionMatches=$availableRegions.not('.inactive').length;$regionPopup.find('.regionCount').html(regionMatches+'/'+$availableRegions.length);$regionPopup.find('.contribute').toggle(regionMatches===0)}}$(window).keyup(function(e){var n=e.which||e.keyCode||0;if(!$('#region').hasClass('visible')||n==27){if(n==27){closePopup()}else if(n==32&&!$('.popover').hasClass('visible')&&!$body.hasClass('bulkPause')){getName()}else if(n==48){$infoToggle.click()}else if(n==49){$genderToggles.find('a').first().click()}else if(n==50){$genderToggles.find('a:eq(1)').click()}else if(n==51){$genderToggles.find('a').last().click()}else if(n==52){$regionToggle.click()}else if(n==53){$bulkToggle.click()}else if(n==67&&!$body.hasClass('touch-device')&&!$body.hasClass('bulk')&&$name.find('em').length==0){selectThis($name[0])}}});$name.on('touchend',function(){getName()})})();(function(){var title=document.title;$(window).on('blur focus',function(){document.title=document.hidden?'ðŸ‘€ '+title:title})})();